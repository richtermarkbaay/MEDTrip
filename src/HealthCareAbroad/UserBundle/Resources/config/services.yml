parameters:
    services.user_class: HealthCareAbroad\UserBundle\Services\UserService
    services.institution_user_class: HealthCareAbroad\UserBundle\Services\InstitutionUserService
    services.admin_user_class: HealthCareAbroad\UserBundle\Services\AdminUserService

services:
    services.user:
        class: %services.user_class%
        calls: 
            - [setChromediaRequest, [@services.chromedia_request]]
            - [setChromediaAccountsUri, [%chromedia_accounts_uri%]]
            
    services.institution_user:
        class: %services.institution_user_class%
        calls:
            - [setDoctrine, [@doctrine]]
            - [setChromediaRequest, [@services.chromedia_request]]
            - [setChromediaAccountsUri, [%chromedia_accounts_uri%]]
            - [setSession, [@session]]
            - [setSecurityContext, [@security.context]]
    services.admin_user:
        class: %services.admin_user_class%
        calls:
            - [setDoctrine, [@doctrine]]
            - [setChromediaRequest, [@services.chromedia_request]]
            - [setChromediaAccountsUri, [%chromedia_accounts_uri%]]
            - [setSession, [@session]]
            - [setSecurityContext, [@security.context]]
            
    ## listeners below
    listener.user.institution_user.create:
        class: HealthCareAbroad\UserBundle\Listener\InstitutionUserListener
        calls:
            - [setEntityManager, [@doctrine.orm.entity_manager]]
        tags:
            - { name: kernel.event_listener, event: event.institution_user.create, method: onCreate }
    listener.event.institution_user_password.change:
        class: HealthCareAbroad\UserBundle\Listener\InstitutionUserListener
        calls:
            - [setEntityManager, [@doctrine.orm.entity_manager]]
        tags:
            - { name: kernel.event_listener, event: event.institution_user_password.change, method: onChangePassword }        
    listener.mailer.institution_user.create:
        class: HealthCareAbroad\MailerBundle\Listener\InstitutionUserListener
        tags:
            - { name: kernel.event_listener, event: event.institution_user.create, method: onCreate }