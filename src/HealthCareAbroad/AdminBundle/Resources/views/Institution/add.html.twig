{% extends 'AdminBundle::layout.html.twig' %}
{% set selectedTab = 'institutions'%}
{% set selectedSubTab = 'institutions_add'%}

{% block content %}
    <div id="content">
        {% embed '::contentWrapper.admin.html.twig' %}
            {% block wrappedContent %}
            
          <div class="addcenterbox">
			 	<div class="row-fluid">
				    <div class="span12">
				            <div class="tabbable">
								<!-- /.menu - tab start -->
								        {% include '::notice.admin.html.twig' %}
						
								    {% include '::stepHolder.base.admin.html.twig' with {
						                    steps: [
						                        {title: '- Create Account', 'selected': true},
						                        {title: '- Add Institution Details'},
						                        
						                 ]}
						              %}							
								<!-- /.menu - tab end -->
								<!-- /.tab-content start -->
								<div class="tab-content">
									<div id="tabs1-pane1" class="tab-pane active">
													
										<form novalidate="novalidate" name="account" action="{{ path('admin_institution_add') }}" method="POST" class="form">
					
					                    <h5>Create USER account.</h5>
					                     {{ form_errors(form) }}
					                        <label for="username">Email 
					                            <span><small style="font-size:85% ; color: #ccccc;">&nbsp;(your own email not the email of the institution)</small></span>
					                        </label>
					                     <input type="button" class="btn btn-info" value="Generate Email" onClick="randomString();" style="float: right;margin-right: 687px;margin-top: 4px;">
					                        <div class="input-prepend" >
						                      	{{ form_widget(form.email) }}
						                  
					                        </div>
					                 
						                        {% if form_errors(form.email) %}
					  								<ul class="alert-error">
						                                <li>
					                                         {{ form_errors(form.email) }}
						                                </li>
									  				</ul>
						  						{% endif %}
					                        
				                            {{ form_row(form.password) }}
					                        {{ form_row(form.confirm_password) }}
					                        {{ form_row(form.name) }}
					               
					                       <input type="checkbox" name="medicalGroupBox" id="medicalGroupBox" >
					                       <span>I belong to a group / Network</span>
    					                       <div id="medicalProviderGroupsInput">
    					                                {{ form_row(form.medicalProviderGroups) }}
    					                        </div>
					                        <hr>
                                            <div>
                                                <label for="institutionTypes">Types of Institution</label>
                                                {% for _key, _typeChoice in form.type.vars.choices %}
                                                    <div>
                                                        {% set _inputId =  form.type.vars.id ~ '_' ~ _key %}
                                                        <input id="{{ _inputId }}" type="radio" value="{{ _typeChoice.value }}" required="required" name="{{ form.type.vars.full_name }}">
                                                        <span class="required" for="institutionSignUp_type_1">{{ _typeChoice.label }}</span>
                                                    </div>
                                                {% endfor %}
                                                {{ form_errors(form.type) }}
                                            </div>
                                            <hr>
					               
					                    <input type="submit" name="Submit" value="Next" class="btn-large btn-primary" />
					                      {{ form_widget(form._token) }}
					                </form>
									</div>
								
								</div><!-- /.tab-content end -->
							</div>
					    </div><!--/span 12 end-->
					 </div><!--/row-fluid end-->
				 </div>
             
            {% endblock %}
        {% endembed %}
    </div>
    
{% endblock %}
{% block inlineJavascriptCode %}
	<script language="javascript" type="text/javascript">

    $('#medicalProviderGroupsInput').hide();
    	$('#medicalGroupBox').click(function(){
        	
    	    if ($('#medicalGroupBox').attr('checked')) {

    	    	$('#medicalProviderGroupsInput').show();
    	    	
    	    }else{
        	    $('#medicalProviderGroupsInput').hide();
        	}
    	}) 
	
    <!-- AutoComplete for Institution Medical Group Input Field -->
    
        $(function() {
        	var availableTags = $.parseJSON('{{ medicalProvidersJSON | raw}}');
        	
            $( "#institutionSignUp_medicalProviderGroups" ).autocomplete({
                source: availableTags
            });
        });    
	
		function randomString() {
			var chars = "abcdefghiklmnopqrstuvwxyz";
			var string_length = 8;
			//var inputVal = document.getElementById('institutionSignUp_email');
			var institutionSignUp = '';
			for (var i=0; i<string_length; i++) {
				var rnum = Math.floor(Math.random() * chars.length);
				institutionSignUp += chars.substring(rnum,rnum+1) ;
			}
			//document.account.inputVal.value = institutionSignUp[email];
			
		 document.getElementById("institutionSignUp_email").value = institutionSignUp + "@healthcareabroad.com" ;
		}

	</script>	
{% endblock %}
