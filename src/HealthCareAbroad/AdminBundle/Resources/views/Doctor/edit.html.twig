{% extends 'AdminBundle::layout.html.twig' %}
{% set selectedTab = 'manageHcaData' %}
{% set selectedSubTab = 'manage_doctors' %}

{% block content %}
<!-- start content -->
<div id="content">
    <!--  start page-heading -->
    <div id="page-heading">
        <h1> {{ title }} </h1>
    </div>
    <!-- end page-heading -->
    
    {% embed '::contentWrapper.admin.html.twig' %}
        
        {% block wrappedContent %}
            <table style="width:100%;">
                <tr>
                    <td style="vertical-align: top; ">
                        
                        <!--  start table-content  -->
                        <div id="table-content">
                            {% include '::notice.admin.html.twig' %}
                        
                            {% if doctor.id %}
                                {% set contents = [{
                                        'title': 'Add doctor',
                                        'description': 'Add new doctor',
                                        'class': 'add-icon',
                                        'href': path('admin_doctor_add'),
                                        'links': [{'title': 'Add a doctor', 'href': path('admin_doctor_add')}]
                                    }]
                                %}
                            {% else %}
                                {% set contents = [{
                                        'title': 'View all doctors',
                                        'description': 'View all doctors',
                                        'class': 'add-icon',
                                        'href': path('admin_doctor_index'),
                                        'links': [{'title': 'List of Doctors', 'href': path('admin_doctor_index')}]
                                    }]
                                %}
                            {% endif %}
            
                            {% include '::relatedTasks.base.admin.html.twig' with {contents: contents} %}
                            <form novalidate="novalidate" action="{{ doctor.id ? path('admin_doctor_edit_save', {'idId': doctor.id }) : path('admin_doctor_add_save') }}" method="POST" {{ form_enctype(form) }} class="basic-form">
                                <!-- start id-form -->
                                <table border="0" cellpadding="0" cellspacing="0"  id="id-form">
                                    
                                    {{ form_row(form.firstName) }}
                                    {{ form_row(form.middleName) }}
                                    {{ form_row(form.lastName) }}
                                    {{ form_row(form.specializations) }}
                                    {{ form_row(form.contactEmail) }}
                                    <div>
		                            {% set arrContactNumber = json_decode(doctor.contactNumber) %}
		
		                            {% if not arrContactNumber|length %}
		                                {% set arrContactNumber = [{"number" : "", "type": ""}] %}
		                            {% endif %}
		                        
		                            {{ form_label(form.contactNumber) }}
		
		                            <div style="margin-bottom: 5px;display:inline-block;" id="contactNumberContainer">
		                                {% for i, contact in arrContactNumber %}
		                                    <div id="contact-{{ i }}">
		                                        <input type="text" name="contactNumber[{{ i }}][number]" value="{{ contact.number}}">
		                                        <a href="javascript:addAnotherContact()" class="add-another-number"> add another</a> 
		                                        <span class="bar"> | </span> 
		                                        <a href="javascript:removeContact({{ i }})" class="remove-contact">remove</a>
		                                        <div style="margin-top: 3px;font-size: 11px;padding-left:5px;">
		                                            <input type="radio" name="contactNumber[{{ i }}][type]" value="phone" id="phone{{ i }}" {{ ('phone' == contact.type) or ('' == contact.type) ? 'checked' : '' }}><label for="phone{{ i }}">Phone</label> &nbsp;
		                                            <input type="radio" name="contactNumber[{{ i }}][type]" value="mobile" id="mobile{{ i }}" {{ 'mobile' == contact.type ? 'checked' : '' }}><label for="mobile{{ i }}">Mobile</label> &nbsp;
		                                            <input type="radio" name="contactNumber[{{ i }}][type]" value="fax"  id="fax{{ i }}" {{ 'fax' == contact.type ? 'checked' : '' }}><label for="fax{{ i }}">Fax</label>
		                                        </div>
		                                    </div> 
		                                {% endfor %}
		                            </div>
		                        </div>
                                    {{ form_rest(form) }}
                                    <input type="reset" value="Reset" class="form-reset"/>
                                    <input type="submit" name="submit" value="Submit" class="green-button" />
                                </table>
                                <!-- end id-form  -->
                            </form>
                        </div>
                        <!--  end table-content  -->
                    </td>
                    <td style="vertical-align: top; ">
                        
                    </td>
                </tr>
            </table>
        {% endblock %}
        
    {% endembed %}
    
</div>
<!--  end content -->
<div class="clear">&nbsp;</div>
{% endblock %}

{% block inlineJavascriptCode %}
	<script type="text/javascript">

	$(function() {
    	$('#contactNumberContainer > :first-child').find('.bar, .remove-contact:first').hide();
	});

	function addAnotherContact()
	{
	    var $lastElemContact = $('#contactNumberContainer > :last-child');
	    var i = parseInt($lastElemContact.attr('id').split('-').pop()) + 1;
	    var $newContact = $lastElemContact.clone().attr('id', 'contact-'+ i);

	    var radioBtnName = 'contactNumber[' + i + '][type]';

        $newContact.find('input:text').attr('name', 'contactNumber[' + i + '][number]').val('');
        $newContact.find('.bar, .remove-contact').show();
        $newContact.find('.remove-contact').attr('href', 'javascript:removeContact('+ i +')');
        $newContact.find('input:radio[value=phone]').attr('id', 'phone' + i).attr('name', radioBtnName).next().attr('for', 'phone'+i);
        $newContact.find('input:radio[value=mobile]').attr('id', 'mobile' + i).attr('name', radioBtnName).next().attr('for', 'mobile'+i);
        $newContact.find('input:radio[value=fax]').attr('id', 'fax' + i).attr('name', radioBtnName).next().attr('for', 'fax'+i);

	    $('#contactNumberContainer').append($newContact);
	}

	function removeContact(i)
	{
		$('#contact-' + i).remove();
	}
	</script>	
{% endblock %}



