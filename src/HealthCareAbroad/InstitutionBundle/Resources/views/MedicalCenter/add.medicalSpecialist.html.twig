{# if institution is of type single center, use unauthenticated layout as base, since this is part of the signup process #}
{% extends  isSingleCenter ?  'InstitutionBundle::unauthenticated.layout.html.twig' : 'InstitutionBundle::layout.html.twig' %}
{% set disableMainNavigation = true %}
{% block content %}

    {% embed 'InstitutionBundle:Embed:contentWrapper.authenticated.html.twig' 
        with {'contentSpanClass' : 'span12' } %}
        {% block wrappedContent %}
        <div class="span12">
            <h1><span>Create New Clinic Listing</span></h1>
            {% include 'InstitutionBundle:Widgets:steps.addClinic.html.twig' with {activeStep: 'medical_specialists'} %}
        </div>
        <div class="addnewclinic">
        	<div class="span9">
        	    <form novalidate="novalidate" method="POST" class="" >
        	        <div>
        	            <label for="username">Search and Add your Medical Specialist</label>
        	            {{ form_widget(form.firstName) }}
        	            <img style="display:none; width:180px;margin:-25px 0px 0px 10px;" id="loader_ajax" src="{{ asset('images/institution/loading2.gif') }}" />
                        {{ form_row(form.id) }}
                        {{ form_rest(form) }}
                          <table class="table table-striped table-bordered specialist_table">
                             <thead>
                                <tr>    
                    				<th>Medical Specialist</th>
                    				<th>Specializations</th>
                    				<th>Actions</th>
                        		</tr>
                             </thead>
                             <tbody>
                        		<tr style="display:none;" class="loader"><td colspan="2">Loading...</td></tr>
                        		{% include 'InstitutionBundle:MedicalCenter:tableRow.specialist.html.twig' %}
                            </tbody>
                    	</table>
            			
        	        </div>
        	        
        	        <div class="clearfix"></div>
        		    
        		    <div class="pull-left">
                        <button class="btn btn-info previous_button" type="button">Previous</button>
                    </div>
        		    
        		    <div class="pull-right">
                        <button class="btn btn-primary btn-large submit_button" type="submit">Submit</button>
                    </div>
        	    </form>
        	</div>
        	
        	{% embed 'InstitutionBundle:Embed:wrapper.sidebar.html.twig' %}
                {% block sidebarWrappedContent %}
                     {% set helptext = get_help_text_by_route('add_specialists')%}
                     {{ helptext | raw }}
                {% endblock %}
            {% endembed %}
        	
    	</div>
        {% endblock %}
        
    {% endembed %}
<div id="specialistModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	    {% set _commonDeleteCsrfTokenWidget = _commonDeleteCsrfTokenWidget is defined ? _commonDeleteCsrfTokenWidget : form_widget(commonDeleteForm._token) %}
	    <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
            <h3>Delete Specialist</h3>
        </div>
        <div class="modal-body">
            <p>Are you sure you want to remove
            	<strong> </strong>
            </p>
        </div>
        <div class="modal-footer">
            <form action="{{ path('institution_medicalCenter_ajaxRemoveSpecialistService', {'imcId': institutionMedicalCenter.id, 'institutionId': institution.id } ) }}">
                {{ _commonDeleteCsrfTokenWidget | raw }}
                 <input type="hidden" name="id" class="doctorHiddenId" id="id" value=""/>
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
        	    <button data-loading-text="Processing..." class="btn btn-danger delete-button" type="button" onclick="InstitutionMedicalCenter.submitRemoveMedicalSpecialistForm(this); return true;">Delete</button>
            </form>
        </div>
    </div>
{% endblock %}
 
{% block inlineJavascriptCode %}
    <script src="{{ asset('bundles/institution/js/institutionMedicalCenter.js') }}"></script>
	<script type="text/javascript">

		$(function() {
			InstitutionSpecialistAutocomplete.removePropertyUri = '{{ path("institution_medicalCenter_ajaxRemoveSpecialistService", {"imcId" : institutionMedicalCenter.id, "institutionId" : institution.id} ) }}';
			
			InstitutionSpecialistAutocomplete
	        .setLoadHtmlContentUri('{{ path("institution_medicalCenter_ajaxAddSpecialistService", {"imcId": institutionMedicalCenter.id, "institutionId": institution.id}) }}') 
	        .setLoadMedicalSpecialistUri('{{ path("institution_medicalCenter_loadMedicalSpecialist", {"imcId": institutionMedicalCenter.id}) }}')
	        .setAutocompleteOptions('specialist', {
	            source: '',
	            target: $('#institutionDoctorSearch_firstName'),
	            selectedDataContainer: $('table.specialist_table tbody'),
	            loader: $('table.specialist_table tbody tr.loader'),
                field: $('#institutionDoctorSearch_firstName')
	        })
	        .autocomplete();

        	$('button.previous_button').click(function(){
                window.location = "{{ path('institution_medicalCenter_addGlobalAwards', {'imcId': institutionMedicalCenter.id} )}}";
            });
		});

		</script>	
{% endblock %}