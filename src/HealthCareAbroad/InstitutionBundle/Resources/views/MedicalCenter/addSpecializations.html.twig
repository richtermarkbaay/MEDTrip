{# if institution is of type single center, use unauthenticated layout as base, since this is part of the signup process #}
{% extends  isSingleCenter ?  'InstitutionBundle::unauthenticated.layout.html.twig' : 'InstitutionBundle::layout.html.twig' %}
{% set mainNavigation = {selected: 'medical_centers'} %}

{# disable the navigation for single center type institution since this is part of the sign up process #}
{% set disableMainNavigation = isSingleCenter is defined and isSingleCenter %}


{% block content %}

    {% embed 'InstitutionBundle:Embed:contentWrapper.authenticated.html.twig' 
        with {'contentSpanClass' : 'span12' } %}
        {% block wrappedContent %}

       <div class="span12">
            
            <h1><span>Create New Clinic Listing</span></h1>
            {% include 'InstitutionBundle:Widgets:steps.addClinic.html.twig' with {activeStep: 'specializations'} %}
        </div>
        <div class="addnewclinic">
        	<div class="span9">
        	{% include '::notice.admin.html.twig' %}
        	    
        	    <label>Search and Add your SPECIALIZATIONS</label>
                {{ form_widget(form.specialization_selector) }}
                <div id="specializationLoading" class="ajax-loading" style="display:none">loading . . .</div>
                
                <form class="specialization_form" action="{{ path('institution_medicalCenter_addSpecializations_save', { 'imcId':institutionMedicalCenter.id}) }}" method="POST" >
        		    <div id="specializationAccordion"></div>
        		    
        		    <div class="pull-left">
                        <button class="btn btn-info previous_button" type="button">Previous</button>
                    </div>
        		    
        		    <div class="pull-right">
                        <button class="btn btn-info" type="submit">Next</button>
                    </div>
    		    </form>
        	</div>
        	{% embed 'InstitutionBundle:Embed:wrapper.sidebar.html.twig' %}
                {% block sidebarWrappedContent %}
                    {% include 'InstitutionBundle:Widgets:sidebar.benefitsShowcase.html.twig' %}
                {% endblock %}
            {% endembed %}
        	

        </div>
        {% endblock %}
        
    {% endembed %}
{% endblock %}

{% block inlineJavascriptCode %}
<script src="{{ asset('bundles/institution/js/institutionTreatments.js') }}" type="text/javascript"></script>
<script type="text/javascript">
<!--
(function($){
    $(function(){
        $('button.previous_button').click(function(){
            window.location = "{{ isSingleCenter ? path('institution_signup_complete_profile') : path('institution_medicalCenter_addDetails', {imcId: institutionMedicalCenter.id} ) }}";

            return false;
        });

        InstitutionSpecializationAutocomplete
        .setAutocompleteOptions({
            source : $.parseJSON('{{ specializationsJSON | raw}}'),
            target: $('input.autocomplete_specialization_selector'),
            selectedDataContainer: $('#specializationAccordion') 
        })
        .setLoaderElement($('#specializationLoading'))
        .setLoadSpecializationFormUri('{{ path("helper_specializationAccordionEntry") }}')
        .autocomplete();
    });
})(jQuery);
//-->
</script>
{% endblock %}