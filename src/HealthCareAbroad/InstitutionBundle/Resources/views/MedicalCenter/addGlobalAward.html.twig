{# if institution is of type single center, use unauthenticated layout as base, since this is part of the signup process #}
{% extends  isSingleCenter ?  'InstitutionBundle::unauthenticated.layout.html.twig' : 'InstitutionBundle::layout.html.twig' %}
{% set mainNavigation = {selected: 'medical_centers'} %}

{# disable the navigation for single center type institution since this is part of the sign up process #}
{% set disableMainNavigation = isSingleCenter is defined and isSingleCenter %}


{% block content %}

    {% embed 'InstitutionBundle:Embed:contentWrapper.authenticated.html.twig' 
        with {'contentSpanClass' : 'span12' } %}
        {% block wrappedContent %}

       <div class="span12">
            
            <h1><span>Create New Clinic Listing</span></h1>
            {% include 'InstitutionBundle:Widgets:steps.addClinic.html.twig' with {activeStep: 'awards'} %}
        </div>
        <div class="addnewclinic">
        	<div class="span9">
                
                <form  action="{{ path('institution_medicalCenter_addGlobalAwards', { 'imcId':institutionMedicalCenter.id}) }}" method="POST" >
                    
                        {% set _awardsByType = {
                            'awards': {
                                'fieldId': 'awards_field',
                                'containerId': 'awards',
                                'header': 'Awards',
                                'tableId': 'awards_table',
                                'selectorFieldLabel': form_label(form.awards_selector),
                                'selectorFieldWidget': form_widget(form.awards_selector, {attr: {class:'global_award_autocomplete', 'data-globalAwardType': 'award', 'data-globalAwardContainer': 'table.awards_table tbody', 'data-fieldId' : '.awards_field'} }),
                                'list': currentGlobalAwards.award
                            },
                            'certifications': {
                                'fieldId': 'certifications_field',
                                'containerId': 'certifications',
                                'header': 'Certifications',
                                'tableId': 'certificates_table',
                                'selectorFieldLabel': form_label(form.certifications_selector),
                                'selectorFieldWidget': form_widget(form.certifications_selector, {attr: {class:'global_award_autocomplete','data-globalAwardType': 'certificate', 'data-globalAwardContainer': 'table.certificates_table tbody', 'data-fieldId' : '.certifications_field'} }),
                                'list': currentGlobalAwards.certificate
                            },
                            'affiliations': {
                                'fieldId': 'affiliations_field',
                                'containerId': 'affiliations',
                                'header': 'Affilliations',
                                'tableId': 'affiliations_table',
                                'selectorFieldLabel': form_label(form.affiliations_selector),
                                'selectorFieldWidget': form_widget(form.affiliations_selector, {attr: {class:'global_award_autocomplete','data-globalAwardType': 'affiliation', 'data-globalAwardContainer': 'table.affiliations_table tbody', 'data-fieldId' : '.affiliations_field'} }),
                                'list': currentGlobalAwards.affiliation
                            },
                            'accreditations': {
                                'fieldId': 'accreditations_field',
                                'containerId': 'accreditations',
                                'header': 'Accreditations',
                                'tableId': 'accreditation_table',
                                'selectorFieldLabel': form_label(form.accreditations_selector),
                                'selectorFieldWidget': form_widget(form.accreditations_selector, {attr: {class:'global_award_autocomplete','data-globalAwardType': 'accreditation', 'data-globalAwardContainer': 'table.accreditation_table tbody', 'data-fieldId' : '.accreditations_field'} }),
                                'list': currentGlobalAwards.accreditation
                            }
                        }
                    %}
                    
                    {% for _awardsListData in _awardsByType %}
                        {% include 'InstitutionBundle:MedicalCenter/Partials:awardsList.base.html.twig' with { 'awardsList': _awardsListData } %}
                    {% endfor %}
                        
                    {{ form_widget(form._token) }}
                    
                    <div class="clearfix"></div>
        		    
        		    <div class="pull-left">
                        <button class="btn btn-info previous_button" type="button">Previous</button>
                    </div>
        		    
        		    <div class="pull-right">
                        <button class="btn btn-info next_button" type="button">Next</button>
                    </div>
    		    </form>
        	</div>
        	
        	{% embed 'InstitutionBundle:Embed:wrapper.sidebar.html.twig' %}
                {% block sidebarWrappedContent %}
                     {% set helptext = get_help_text_by_route('add_awards_certifications_affiliations')%}
                     {{ helptext | raw }}
                {% endblock %}
            {% endembed %}

        </div>
        
        {% include 'InstitutionBundle:Widgets/Modals:modal.deleteInstitutionMedicalCenterGlobalAwards.html.twig' %}
        {% include 'InstitutionBundle:Widgets/Modals:modal.editGlobalAward.html.twig' %}
        
        {% endblock %}
        
    {% endembed %}

    
{% endblock %}

{% block inlineJavascriptCode %}
<script src="{{ asset('bundles/institution/js/institutionMedicalCenter.js') }}" type="text/javascript"></script>
<script type="text/javascript" src="{{ asset('bundles/institution/js/properties.js') }}" ></script>
<script type="text/javascript">
<!--
(function($){
    $(function(){

        $('div.edit_award_form_container').find('input.globalAward_autocompleteYear').globalAward('autocompleteYear');
        
        $('a.edit_global_award').globalAward('edit', {
            'modal': $('div.edit_award_form_container'),
            'data_label_target': $('div.edit_award_form_container').find('.editAwardForm_awardName'),
            'input_extraValueAutocomplete': 'input.globalAward_autocompleteYear' 
        });
        
        $('button.previous_button').click(function(){
            window.location = "{{ path('institution_medicalCenter_addAncilliaryServices', {imcId: institutionMedicalCenter.id} ) }}";

            return false;
        });

        $('button.next_button').click(function(){
            window.location = "{{ path('institution_add_medical_specialist', {imcId: institutionMedicalCenter.id} ) }}";

            return false;
        });

        $.GlobalAutocompleteAction.setLoadHtmlContentUri('{{ path("institution_medicalCenter_ajaxAddGlobalAward", {"imcId": institutionMedicalCenter.id}) }}');

        $('input.global_award_autocomplete').globalAward('autocompleteAward', {
            'remoteUrl': '{{ path("institution_medicalCenter_ajaxGlobalAwardSource", {institutionId: institution.id,imcId: institutionMedicalCenter.id}) }}' 
        });
        
    });
    
})(jQuery);
//-->
</script>
{% endblock %}