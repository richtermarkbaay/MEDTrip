{# if institution is of type single center, use unauthenticated layout as base, since this is part of the signup process #}
{% extends  isSingleCenter ?  'InstitutionBundle::unauthenticated.layout.html.twig' : 'InstitutionBundle::layout.html.twig' %}
{% set mainNavigation = {selected: 'medical_centers'} %}

{# disable the navigation for single center type institution since this is part of the sign up process #}
{% set disableMainNavigation = isSingleCenter is defined and isSingleCenter %}


{% block content %}

    {% embed 'InstitutionBundle:Embed:contentWrapper.authenticated.html.twig' 
        with {'contentSpanClass' : 'span12' } %}
        {% block wrappedContent %}

       <div class="span12">
            
            <h1><span>Create New Clinic Listing</span></h1>
            {% include 'InstitutionBundle:Widgets:steps.addClinic.html.twig' with {activeStep: 'awards'} %}
        </div>
        <div class="addnewclinic">
        	<div class="span9">
                
                <form  action="{{ path('institution_medicalCenter_addGlobalAwards', { 'imcId':institutionMedicalCenter.id}) }}" method="POST" >
                    
                    <div id="awards">
                        {{ form_label(form.awards_selector) }}
                        {{ form_widget(form.awards_selector) }}
                        
                        <table class="table table-striped table-bordered awards_table">
                            <thead>
                                <tr>
    								<th>Awards</th>
    								<th>Actions</th>
    							</tr>
                            </thead>
							<tbody>
    							<tr style="display:none;" class="loader"><td colspan="2">Loading...</td></tr>
    							{% for _award in currentGlobalAwards.award %}
    							    {% include 'InstitutionBundle:MedicalCenter/Partials:row.globalAward.html.twig' with {'award': _award.global_award} %}
    							{% endfor %}
    						</tbody>
    					</table>
                    </div>
                    
                    <div id="certifications">
                        {{ form_label(form.certifications_selector) }}
                        {{ form_widget(form.certifications_selector) }}
                        
                        <table class="table table-striped table-bordered certificates_table">
                            <thead>
                                <tr>
    								<th>Certifications</th>
    								<th>Actions</th>
    							</tr>
                            </thead>
							<tbody>
    							<tr style="display:none;"  class="loader"><td colspan="2" >Loading...</td></tr>
    							{% for _award in currentGlobalAwards.certificate %}
    							    {% include 'InstitutionBundle:MedicalCenter/Partials:row.globalAward.html.twig' with {'award': _award.global_award} %}
    							{% endfor %}
    						</tbody>
    					</table>
                    </div>
                    
                    <div id="affiliations">
                        {{ form_label(form.affiliations_selector) }}
                        {{ form_widget(form.affiliations_selector) }}
                        
                        <table class="table table-striped table-bordered affiliations_table">
                            <thead>
                                <tr>
    								<th>Affilliations</th>
    								<th>Actions</th>
    							</tr>
                            </thead>
							<tbody>
    							<tr style="display:none;"  class="loader"><td colspan="2">Loading...</td></tr>
    							{% for _award in currentGlobalAwards.affiliation %}
    							    {% include 'InstitutionBundle:MedicalCenter/Partials:row.globalAward.html.twig' with {'award': _award.global_award} %}
    							{% endfor %}
    						</tbody>
    					</table>
                    </div>
                    
                    <div id="accreditations">
                        {{ form_label(form.accreditations_selector) }}
                        {{ form_widget(form.accreditations_selector) }}
                        
                        <table class="table table-striped table-bordered accreditation_table">
                            <thead>
                                <tr>
            						<th>Accreditations</th>
            						<th>Actions</th>
            					</tr>
                            </thead>
            				<tbody>
            					<tr style="display:none;"  class="loader"><td colspan="2">Loading...</td></tr>
                				{% for _award in currentGlobalAwards.accreditation %}
                				    {% include 'InstitutionBundle:MedicalCenter/Partials:row.globalAward.html.twig' with {'award': _award.global_award} %}
                				{% endfor %}
            				</tbody>
            			</table>
                    </div>
                    
                    {{ form_widget(form._token) }}
                    
                    <div class="clearfix"></div>
        		    
        		    <div class="pull-left">
                        <button class="btn btn-info previous_button" type="button">Previous</button>
                    </div>
        		    
        		    <div class="pull-right">
                        <button class="btn btn-info next_button" type="button">Next</button>
                    </div>
    		    </form>
        	</div>
        	
        	{% embed 'InstitutionBundle:Embed:wrapper.sidebar.html.twig' %}
                {% block sidebarWrappedContent %}
                    {% include 'InstitutionBundle:Widgets:sidebar.benefitsShowcase.html.twig' %}
                {% endblock %}
            {% endembed %}

        </div>
        {% endblock %}
        
    {% endembed %}

    
{% endblock %}

{% block inlineJavascriptCode %}
<script src="{{ asset('bundles/institution/js/institutionMedicalCenter.js') }}" type="text/javascript"></script>
<script type="text/javascript">
<!--
(function($){
    $(function(){
        $('button.previous_button').click(function(){
            window.location = "{{ path('institution_medicalCenter_addAncilliaryServices', {imcId: institutionMedicalCenter.id} ) }}";

            return false;
        });

        $('button.next_button').click(function(){
            window.location = "{{ path('institution_add_medical_specialist', {imcId: institutionMedicalCenter.id} ) }}";

            return false;
        });

        var _nsUrl = '{{ path("institution_medicalCenter_ajaxGlobalAwardSource", {imcId: institutionMedicalCenter.id}) }}';
        InstitutionGlobalAwardAutocomplete
        .setLoadHtmlContentUri('{{ path("institution_medicalCenter_ajaxAddGlobalAward", {"imcId": institutionMedicalCenter.id}) }}') 
        .setAutocompleteOptions('award', {
            source: _nsUrl+'?type=award',
            target: $('input.award_selector'),
            selectedDataContainer: $('table.awards_table tbody'),
            loader: $('table.awards_table tbody tr.loader')
        })
        .setAutocompleteOptions('certificate', {
            source: _nsUrl+'?type=certificate',
            target: $('input.certificate_selector'),
            selectedDataContainer: $('table.certificates_table tbody'),
            loader: $('table.certificates_table tbody tr.loader')
        })
        .setAutocompleteOptions('affiliation', {
            source: _nsUrl+'?type=affiliation',
            target: $('input.affiliation_selector'),
            selectedDataContainer: $('table.affiliations_table tbody'),
            loader: $('table.affiliations_table tbody tr.loader')
        })
        .setAutocompleteOptions('accreditation', {
            source: _nsUrl+'?type=accreditation',
            target: $('input.accreditations_selector'),
            selectedDataContainer: $('table.accreditation_table tbody'),
            loader: $('table.accreditation_table tbody tr.loader')
        })
        .autocomplete();
        
        
    });
    
})(jQuery);
//-->
</script>
{% endblock %}