{% embed 'InstitutionBundle:Widgets:tabbedContent.base.html.twig' %}
    {% block tabbedContent %}
    <form action="{{ path('institution_addGlobalAwards', { 'institutionId':institution.id}) }}" method="POST" >
        <div id="awards">
            {{ form_label(form.awards_selector) }}
            {{ form_widget(form.awards_selector) }}
            
            <table class="table table-striped table-bordered awards_table">
                <thead>
                    <tr>
						<th>Awards</th>
						<th>Actions</th>
					</tr>
                </thead>
				<tbody>
					<tr style="display:none;" class="loader"><td colspan="2">Loading...</td></tr>
					{% for _award in currentGlobalAwards.award %}
					    {% include 'InstitutionBundle:Institution:tableRow.globalAward.html.twig' with {'award': _award.global_award, 'institution_property': _award.institution_property} %}
					{% endfor %}
				</tbody>
			</table>
        </div>
        
        <div id="certifications">
            {{ form_label(form.certifications_selector) }}
            {{ form_widget(form.certifications_selector) }}
            
            <table class="table table-striped table-bordered certificates_table">
                <thead>
                    <tr>
						<th>Certifications</th>
						<th>Actions</th>
					</tr>
                </thead>
				<tbody>
					<tr style="display:none;"  class="loader"><td colspan="2" >Loading...</td></tr>
					{% for _award in currentGlobalAwards.certificate %}
					    {% include 'InstitutionBundle:Institution:tableRow.globalAward.html.twig' with {'award': _award.global_award, 'institution_property': _award.institution_property} %}
					{% endfor %}
				</tbody>
			</table>
        </div>
        
        <div id="affiliations">
            {{ form_label(form.affiliations_selector) }}
            {{ form_widget(form.affiliations_selector) }}
            
            <table class="table table-striped table-bordered affiliations_table">
                <thead>
                    <tr>
						<th>Affilliations</th>
						<th>Actions</th>
					</tr>
                </thead>
				<tbody>
					<tr style="display:none;"  class="loader"><td colspan="2">Loading...</td></tr>
					{% for _award in currentGlobalAwards.affiliation %}
					    {% include 'InstitutionBundle:Institution:tableRow.globalAward.html.twig' with {'award': _award.global_award, 'institution_property': _award.institution_property} %}
					{% endfor %}
				</tbody>
			</table>
        </div>
        
        {{ form_widget(form._token) }}
        
    </form>
    
    {% endblock %}
{% endembed %}
{% block inlineJavascriptCode %}
    <script type="text/javascript">
        $(function() {
        	InstitutionProfile.removePropertyUri = '{{ path("institution_ajaxRemovePropertyValue", {"institutionId" : institution.id} ) }}';
            
            InstitutionGlobalAwardAutocomplete
            .setLoadHtmlContentUri('{{ path("institution_ajaxAddGlobalAward", {"institutionId": institution.id}) }}') 
            .setAutocompleteOptions('award', {
                source: $.parseJSON('{{ awardsSourceJSON | raw }}'),
                target: $('input.award_selector'),
                selectedDataContainer: $('table.awards_table tbody'),
                loader: $('table.awards_table tbody tr.loader')
            })
            .setAutocompleteOptions('certificate', {
                source: $.parseJSON('{{ certificatesSourceJSON | raw }}'),
                target: $('input.certificate_selector'),
                selectedDataContainer: $('table.certificates_table tbody'),
                loader: $('table.certificates_table tbody tr.loader')
            })
            .setAutocompleteOptions('affiliation', {
                source: $.parseJSON('{{ affiliationsSourceJSON | raw }}'),
                target: $('input.affiliation_selector'),
                selectedDataContainer: $('table.affiliations_table tbody'),
                loader: $('table.affiliations_table tbody tr.loader')
            })
            .autocomplete();
        });
        
    </script>
{% endblock %}