{% extends 'FrontendBundle::layout.html.twig' %}

{#{% block callout %}
    {% include 'SearchBundle:Frontend/Widgets:base.resultsCallout.html.twig' %}
{% endblock %}#}

{% block content %}
    <div class="search-results-wrapper span8">
        {#<h2 class="heading"><strong>{{ searchResults.getTotalResults }}</strong> {{ searchResults.getTotalResults > 1 ? 'Results' : 'Result' }} Found</h2> #}

        <div class="content-profile-widget-wrapper">
            <h3 class="heading">
                We found <em>{{ searchResults.getTotalResults }}</em> {{ searchResults.getTotalResults > 1 ? 'results' : 'result' }}.
            </h3>
            {% if searchResults.isPaginable %}
                <h3 class="heading">Refine your results.</h3>
                {# Refine results form #}
                {% include 'SearchBundle:Frontend/Widgets:narrowsearch.html.twig' %}
            {% endif %}
        </div>

        {{ render_search_results_featured_institution_ad(featuredClinicParams) }}
        {% set _featuredInstitutionIds = get_featured_institutions_by_search_parameters(featuredClinicParams) %}

        {% for searchResultVo in searchResults %}
            {% set institution = searchResultVo.institution is defined ? searchResultVo.institution : searchResultVo %}

            {# https://github.com/chromedia/healthcareabroad/issues/510 #}
            {% if institution.id not in _featuredInstitutionIds %}
                {% set url = get_institution_frontend_url(institution) %}
                {% include 'SearchBundle:Frontend/Widgets:base.resultItem.html.twig' with {
                       'statisticsDataObject': searchResultVo.institution,
                       'searchResultItem' : {
                           url: url,
                           logo: render_institution_logo(institution, {attr: {alt: 'hospital logo', class: 'small'}}),
                           name: institution.name,
                           description: institution.description | striptags,
                           mainAddress: institution_address_to_string(institution, ['city', 'state', 'country']),
                           streetAddress: institution_address_to_string(institution, ['address1', 'zipCode']),
                           links: get_institution_links(institution, url),
                           payingStatus: institution.payingClient
                       }
                    }
                %}
            {% endif %}

        {% endfor %}

        {% if searchResults.isPaginable %}
            {{ paginate(searchResults, routeName, paginationParameters, 'PagerBundle:Pager:paginate_frontend_search.html.twig') }}
        {% endif %}

    </div> <!--End of main_content-->

    <aside class="aside-wrapper span4">
        {{ render_search_results_featured_posts() }}

        {# include 'SearchBundle:Frontend/Widgets:narrowsearch.html.twig' #}

        {{ render_search_results_image_ad() }}
    </aside>

    {#% include 'SearchBundle:Frontend/Widgets:sidebar.resultsSingleSearch.html.twig' with { context: 'destinations', id: destinationId} %#}

{% endblock %}

