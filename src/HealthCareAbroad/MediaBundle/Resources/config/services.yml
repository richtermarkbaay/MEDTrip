parameters:
    services.media.class: HealthCareAbroad\MediaBundle\Services\MediaService
    services.media.pathgenerator.class: HealthCareAbroad\MediaBundle\Generator\Path\DefaultPathGenerator
    services.media.resizer.class: HealthCareAbroad\MediaBundle\Resizer\SquareResizer
    services.media.adapter.class: Imagine\Gd\Imagine 

    mediapathdiscriminators:
            institution: institutions/{objectId}
            doctor: doctors
            advertisement: ads//{objectId}
            advertisementDenormalizedProperty: ads/{objectId}

services:
    services.media.pathgenerator:
        class: %services.media.pathgenerator.class%

    services.media.adapter:
        class: %services.media.adapter.class%

    services.media.resizer:
        class: %services.media.resizer.class%
        arguments:
            - @services.media.adapter

    services.media.filesystemmanager:
        class: HealthCareAbroad\MediaBundle\Gaufrette\FilesystemManager
        arguments:
            - @services.media.pathgenerator
            - %kernel.root_dir%/../web/media
            - %mediapathdiscriminators%

    services.media:
        class: %services.media.class%
        arguments:
            - @services.media.filesystemmanager
            - @doctrine.orm.entity_manager
        calls:
            - [setResizer, [@services.media.resizer]]

    services.media.templating.helper:
        class: HealthCareAbroad\MediaBundle\Templating\Helper\MediaHelper
        tags:
            - { name: templating.helper }
        arguments:
            - @service_container
            - @services.media.filesystemmanager

    services.media.twig.extension.:
        class: HealthCareAbroad\MediaBundle\Twig\Extension\MediaExtension
        public: false
        tags:
            - { name: twig.extension }
        arguments:
            - @services.media.templating.helper
    services.image_type_extension:
        class: HealthCareAbroad\MediaBundle\Form\Extension\ImageTypeExtension
        tags:
            - { name: form.type_extension, alias: file }